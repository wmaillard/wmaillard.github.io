<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ol{margin:0;padding:0}table td,table th{padding:0}.c6{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:20pt;font-family:"Arial";font-style:normal}.c0{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c3{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:16pt;font-family:"Arial";font-style:normal}.c1{orphans:2;widows:2;height:11pt}.c7{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c9{color:#1155cc;text-decoration:underline}.c2{orphans:2;widows:2}.c8{color:inherit;text-decoration:inherit}.c5{text-indent:36pt}.c4{page-break-after:avoid}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style>

<link href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css' rel='stylesheet' type='text/css'>
</head>




<body>

<nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">React Native InstaClone</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li ><a href="HowTo.html">React Native</a></li>
            <li><a href="HowTo2.html">ListView</a></li>
            <li><a href="HowTo3.html">CameraView</a></li>
            <li ><a href="HowTo4.html">Gl-React-Native</a></li>
            <li  class="active"><a href="HowTo5.html">Cloudinary</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>
<div class = 'container-fluid' style="margin-top:100px;"><div class= 'row'><div class='col-xs-8 col-xs-offset-2'>

<h1 class="c2 c4" id="h.ea936mx5qrwb"><span class="c6">Sending your filtered image to Cloudinary and updating your gallery</span></h1><p class="c2"><span>Alright, so we have created a gallery, taken a picture, and added a filter. &nbsp;Now let&#39;s tie everything together by uploading our image to </span><span class="c9"><a class="c8" href="https://www.google.com/url?q=http://cloudinary.com/&amp;sa=D&amp;ust=1470384227489000&amp;usg=AFQjCNFkzEGptgYYSkAecwZKDLUPHJOHMA">Cloudinary</a></span><span class="c0">&nbsp;and the linking our gallery so that it pulls directly from our Cloudinary account.</span></p><p class="c1"><span class="c0"></span></p><h2 class="c2 c4" id="h.v5a03h3a7jcx"><span class="c3">A little bit about Cloudinary</span></h2><p class="c2"><span class="c0">Cloudinary is an image storage server that can store images for you via a RESTful API. &nbsp;You can also retrieve those images (via URL&#39;s) through their API. &nbsp;The great thing about Cloudinary is that you can request that they crop and resize and image before sending it to you, so that it fits perfectly inside your gallery with little work done our your end.</span></p><p class="c1"><span class="c0"></span></p><h2 class="c2 c4" id="h.z147wia3lrlp"><span class="c3">POSTing your image</span></h2><p class="c2"><span class="c0">Here is the quick and dirty of how to POST your image.</span></p><p class="c2"><span class="c0"><pre><code></span></p><p class="c2"><span class="c0">&nbsp; &nbsp;var xhr = new XMLHttpRequest();</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; var body = new FormData();</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; body.append(&#39;upload_preset&#39;, up_preset);</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; body.append(&#39;file&#39;, uri);</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; xhr.open(&#39;POST&#39;, serverUrl);</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; xhr.send(body);</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; xhr.onreadystatechange = function(e){</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(xhr.readyState !==4){</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return;</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(xhr.status === 200){</span></p><p class="c1"><span class="c0"></span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; alert(&#39;Successfully uploaded your photo&#39;);</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var res = JSON.parse(xhr.responseText);</span></p><p class="c1"><span class="c0"></span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }else{</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; console.log(&#39;******************&#39;);</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; console.log(xhr.responseText);</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; alert(&#39;Uploading your image failed :(&#39;)</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; console.warn(&#39;error&#39;);</span></p><p class="c1"><span class="c0"></span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c2"><span class="c0"></pre></code></span></p><p class="c1"><span class="c0"></span></p><p class="c2"><span class="c0">The &#39;serverUrl&#39; is your base url given by Cloudinary (see your admin panel) plus &#39;/image/upload&#39;. &nbsp;&#39;uri&#39; is the base64 encoded string that was passed to us by the &#39;capture()&#39; function. &nbsp;</span></p><p class="c1"><span class="c0"></span></p><p class="c2"><span class="c0">If the image is successfully uploaded you will receive a response with the url of the image, hurray!</span></p><p class="c1"><span class="c0"></span></p><h2 class="c2 c4" id="h.b79fjgs6pquv"><span class="c3">GETing your images</span></h2><p class="c2"><span class="c0">Getting your image is a little more difficult because of a couple quarks in the way that React Native is set up. &nbsp;</span></p><p class="c2"><span>First, you will need to install </span><span class="c9"><a class="c8" href="https://www.google.com/url?q=https://www.npmjs.com/package/base-64&amp;sa=D&amp;ust=1470384227499000&amp;usg=AFQjCNG8rh8ScZsgmeig1m04jaWe9Cnk2Q">Base-64</a></span><span class="c0">, which is not a React Native library, but luckily (this is very rarely the case), works right out of the box with React Native.</span></p><p class="c1"><span class="c0"></span></p><p class="c2"><span class="c0">Now that you have Base-64, you are ready for your Cloudinary GET request:</span></p><p class="c1"><span class="c0"></span></p><p class="c2"><span class="c0"><pre><code></span></p><p class="c2 c5"><span class="c0">&nbsp; &nbsp; var creds = base64.encode(username + &#39;:&#39; + password); </span></p><p class="c2 c5"><span class="c0">&nbsp; &nbsp; var request = new XMLHttpRequest();</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; request.open(&#39;GET&#39;, serverUrl);</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; request.setRequestHeader(&quot;Authorization&quot;, &quot;Basic &quot; + creds);</span></p><p class="c1"><span class="c0"></span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; request.send();</span></p><p class="c1"><span class="c0"></span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; request.onreadystatechange = (e) =&gt; {</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (request.readyState !== 4) {</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return;</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c1"><span class="c0"></span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (request.status === 200) {</span></p><p class="c1"><span class="c0"></span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var responseJson = JSON.parse(request.responseText);</span></p><p class="c1"><span class="c0"></span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; navigator.push({</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; title: &#39;Gallery&#39;,</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; index: 3,</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; outline: &#39;true&#39;,</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; galleryData: responseJson.resources</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; })</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else {</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; console.warn(&#39;error&#39;);</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; console.log(&#39;************request******************&#39;);</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; console.log(request);</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; console.warn(request.responseText);</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c2"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; };</span></p><p class="c2"><span class="c0"></pre></code></span></p><p class="c1"><span class="c0"></span></p><p class="c2"><span class="c0">The toughest part of this request is figuring out how to send an authorization using React Native (see the first couple lines). &nbsp;The url in this case is your base url + &#39;resources/image?max_results=100&#39; (the max is 100, so I would set up code to request more once the user gets deeper in the gallery (listView makes this super easy)) Everything else is pretty standard, and what is returned is an array of image data (request.responseText.resources) from which you can access each image&#39;s url (request.responseText.resoursce[0].url) which is exactly what we need to fill our ListView and update our gallery!</span></p><p class="c1"><span class="c0"></span></p><h1 class="c2 c4" id="h.nduqzu9ywff"><span class="c6">Conclusion</span></h1><p class="c2"><span class="c0">Well, you made it. &nbsp;You have officially set up the framework for an Instagram clone using React Native! &nbsp;From here, you can add more filters and give everything a better looking style. &nbsp;But we have gotten through the hard part and it should be a cakewalk from here!</span></p><p class="c1"><span class="c0"></span></p>


<nav aria-label="Page navigation">
  <ul class="pagination">
    <li class="page-item">
      <a class="page-link" href="HowTo4.html" aria-label="Previous">
        <span aria-hidden="true">&laquo;</span>
        <span class="sr-only">Previous</span>
      </a>
    </li>
    <li class="page-item"><a class="page-link" href="HowTo.html">1</a></li>
    <li class="page-item"><a class="page-link" href="HowTo2.html">2</a></li>
    <li class="page-item"><a class="page-link" href="HowTo3.html">3</a></li>
    <li class="page-item"><a class="page-link" href="HowTo4.html">4</a></li>
    <li class="active page-item"><a class="page-link" href="HowTo5.html">5</a></li>
    <li class="page-item">
      <a class="page-link" href="HowTo5.html" aria-label="Next">
        <span aria-hidden="true">&raquo;</span>
        <span class="sr-only">Next</span>
      </a>
    </li>
  </ul>
</nav>



</body></html>