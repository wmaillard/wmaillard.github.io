<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ol.lst-kix_k7qyvqx66lja-3.start{counter-reset:lst-ctn-kix_k7qyvqx66lja-3 0}.lst-kix_k7qyvqx66lja-6>li{counter-increment:lst-ctn-kix_k7qyvqx66lja-6}.lst-kix_k7qyvqx66lja-0>li{counter-increment:lst-ctn-kix_k7qyvqx66lja-0}.lst-kix_k7qyvqx66lja-3>li{counter-increment:lst-ctn-kix_k7qyvqx66lja-3}ol.lst-kix_k7qyvqx66lja-8.start{counter-reset:lst-ctn-kix_k7qyvqx66lja-8 0}ol.lst-kix_k7qyvqx66lja-0.start{counter-reset:lst-ctn-kix_k7qyvqx66lja-0 0}.lst-kix_k7qyvqx66lja-4>li{counter-increment:lst-ctn-kix_k7qyvqx66lja-4}.lst-kix_k7qyvqx66lja-7>li{counter-increment:lst-ctn-kix_k7qyvqx66lja-7}ol.lst-kix_k7qyvqx66lja-5.start{counter-reset:lst-ctn-kix_k7qyvqx66lja-5 0}.lst-kix_k7qyvqx66lja-3>li:before{content:"" counter(lst-ctn-kix_k7qyvqx66lja-3,decimal) ". "}.lst-kix_k7qyvqx66lja-4>li:before{content:"" counter(lst-ctn-kix_k7qyvqx66lja-4,lower-latin) ". "}ol.lst-kix_k7qyvqx66lja-0{list-style-type:none}ol.lst-kix_k7qyvqx66lja-1{list-style-type:none}.lst-kix_k7qyvqx66lja-2>li:before{content:"" counter(lst-ctn-kix_k7qyvqx66lja-2,lower-roman) ". "}ol.lst-kix_k7qyvqx66lja-2{list-style-type:none}.lst-kix_k7qyvqx66lja-6>li:before{content:"" counter(lst-ctn-kix_k7qyvqx66lja-6,decimal) ". "}ol.lst-kix_k7qyvqx66lja-3{list-style-type:none}ol.lst-kix_k7qyvqx66lja-4{list-style-type:none}ol.lst-kix_k7qyvqx66lja-5{list-style-type:none}.lst-kix_k7qyvqx66lja-0>li:before{content:"" counter(lst-ctn-kix_k7qyvqx66lja-0,decimal) ". "}ol.lst-kix_k7qyvqx66lja-6{list-style-type:none}.lst-kix_k7qyvqx66lja-7>li:before{content:"" counter(lst-ctn-kix_k7qyvqx66lja-7,lower-latin) ". "}.lst-kix_k7qyvqx66lja-8>li:before{content:"" counter(lst-ctn-kix_k7qyvqx66lja-8,lower-roman) ". "}ol.lst-kix_k7qyvqx66lja-7{list-style-type:none}ol.lst-kix_k7qyvqx66lja-8{list-style-type:none}.lst-kix_k7qyvqx66lja-1>li:before{content:"" counter(lst-ctn-kix_k7qyvqx66lja-1,lower-latin) ". "}ol.lst-kix_k7qyvqx66lja-2.start{counter-reset:lst-ctn-kix_k7qyvqx66lja-2 0}ol.lst-kix_k7qyvqx66lja-7.start{counter-reset:lst-ctn-kix_k7qyvqx66lja-7 0}.lst-kix_k7qyvqx66lja-1>li{counter-increment:lst-ctn-kix_k7qyvqx66lja-1}ol.lst-kix_k7qyvqx66lja-6.start{counter-reset:lst-ctn-kix_k7qyvqx66lja-6 0}.lst-kix_k7qyvqx66lja-8>li{counter-increment:lst-ctn-kix_k7qyvqx66lja-8}ol.lst-kix_k7qyvqx66lja-1.start{counter-reset:lst-ctn-kix_k7qyvqx66lja-1 0}.lst-kix_k7qyvqx66lja-2>li{counter-increment:lst-ctn-kix_k7qyvqx66lja-2}ol.lst-kix_k7qyvqx66lja-4.start{counter-reset:lst-ctn-kix_k7qyvqx66lja-4 0}.lst-kix_k7qyvqx66lja-5>li:before{content:"" counter(lst-ctn-kix_k7qyvqx66lja-5,lower-roman) ". "}.lst-kix_k7qyvqx66lja-5>li{counter-increment:lst-ctn-kix_k7qyvqx66lja-5}ol{margin:0;padding:0}table td,table th{padding:0}.c12{background-color:#f7f7f7;color:#333333;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10pt;font-family:"Arial";font-style:normal}.c1{color:#434343;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:"Arial";font-style:normal}.c2{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c11{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:20pt;font-family:"Arial";font-style:normal}.c0{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c3{orphans:2;widows:2}.c8{color:#1155cc;text-decoration:underline}.c6{color:inherit;text-decoration:inherit}.c7{margin-left:36pt;padding-left:0pt}.c10{padding:0;margin:0}.c4{page-break-after:avoid}.c5{height:11pt}.c9{font-weight:700}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style>

<link href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css' rel='stylesheet' type='text/css'>
</head>




<body>

<nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">React Native InstaClone</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li ><a href="HowTo.html">React Native</a></li>
            <li><a href="HowTo2.html">ListView</a></li>
            <li><a href="HowTo3.html">CameraView</a></li>
            <li  class="active"><a href="HowTo4.html">Gl-React-Native</a></li>
            <li><a href="HowTo5.html">Cloudinary</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>
<div class = 'container-fluid' style="margin-top:100px;"><div class= 'row'><div class='col-xs-8 col-xs-offset-2'><h1 class="c3 c4" id="h.f7v1gd9ny0vi"><span class="c11">Adding Filters with gl-react-native</span></h1><p class="c3"><span class="c2">Alright, hopefully everything up to this point went smoothly for you, because things are about to get a whole lot more difficult. &nbsp;Gre has created a fantastic library called gl-react that he has ported to React Native and apply called gl-react-native. &nbsp;This library can add a ton of complex filters over an image and best of all, can capture and store the resulting image. &nbsp;The problem is, the documentation, especially for the React Native port is very slim or relies entirely on example code. &nbsp;For example, to find out if this library was able to capture an image with a filter over it, I had to search through the libraries git issues then use the github search feature to find the actual capture function. &nbsp;With all that in mind, let&#39;s get started.</span></p><p class="c3 c5"><span class="c2"></span></p><h3 class="c3 c4" id="h.acic78p1qltn"><span class="c1">Installation</span></h3><p class="c3"><span>To install, follow the </span><span class="c8"><a class="c6" href="https://www.google.com/url?q=https://github.com/ProjectSeptemberInc/gl-react-native&amp;sa=D&amp;ust=1470383786065000&amp;usg=AFQjCNE8obn8ciI3OqCSDy7utx6qAm1kRg">directions on the main github page</a></span><span>&nbsp;BUT, when you get to the on Android section make the following </span><span class="c9">bold </span><span class="c2">changes:</span></p><p class="c3 c5"><span class="c2"></span></p><p class="c3"><span><pre><code> In your </span><span class="c9">MainApplication</span><span class="c2">&nbsp;(or equivalent) the RNGLPackage needs to be added. Add the import at the top:</span></p><p class="c3"><span class="c2">import com.projectseptember.RNGL.RNGLPackage;</span></p><ol class="c10 lst-kix_k7qyvqx66lja-0 start" start="1"><li class="c3 c7"><span>In order for React Native to use the package, add it the packages inside of the class extending ReactActivity, </span><span class="c9">which is in MainApplication</span><span class="c2">.</span></li></ol><p class="c3"><span>@Override<br>protected List&lt;ReactPackage&gt; getPackages() {<br> &nbsp;return Arrays.&lt;ReactPackage&gt;asList(<br> &nbsp; &nbsp;new MainReactPackage(),<br> &nbsp; &nbsp;...<br> &nbsp; &nbsp;new RNGLPackage()<br> &nbsp;);<br>}</span></p><p class="c3"><span class="c2"></pre></code></span></p><p class="c3"><span class="c2">This is a small change but it can save you the frustration of watching the build fail over and over again.</span></p><p class="c3 c5"><span class="c2"></span></p><p class="c3"><span class="c2">!*Super important tip: While you are developing you may end up installing a library using &#39;rnpm link&#39;. &nbsp;This will break everything! &nbsp;To fix your app, go into build.gradle and delete the line</span></p><p class="c3"><span class="c2"><pre><code>compile project(&#39;:gl-react-native&#39;) </pre></code> that has been added with &#39;rnpm link&#39;</span></p><h3 class="c3 c4" id="h.o9qripxkpdbe"><span class="c1">Your first filter</span></h3><p class="c3 c5"><span class="c2"></span></p><p class="c3"><span class="c2">The next thing to do is set up a view with the standard navigation bar on the top and the rest filled with the Surface and GL.Node elements . &nbsp;I also added a button at the bottom that we&#39;ll use to save our filter. </span></p><p class="c3"><span class="c2">First off, don&#39;t forget your imports:</span></p><p class="c3"><span class="c2"><pre><code> </span></p><p class="c3"><span class="c2">import {Surface} from &quot;gl-react-native&quot;;</span></p><p class="c3"><span class="c2">import GL from &#39;gl-react&#39;;</span></p><p class="c3"><span class="c2"></pre></code></span></p><p class="c3 c5"><span class="c2"></span></p><p class="c3"><span class="c2">&nbsp;And here is the view:</span></p><p class="c3 c5"><span class="c2"></span></p><p class="c3"><span class="c2"><pre><code></span></p><p class="c3"><span class="c2">&lt;View &nbsp;style ={{flex: 1}}&gt;</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; </span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &lt;View style ={{flex: 1}}&gt;</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;Toolbar title={&#39;Photo Preview&#39;} icon={&#39;arrow-back&#39;} onIconPress={this.props.onBack} /&gt;</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &lt;/View&gt;</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; </span></p><p class="c3 c5"><span class="c2"></span></p><p class="c3 c5"><span class="c2"></span></p><p class="c3 c5"><span class="c2"></span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &lt;View style ={{flex: 10}}&gt;</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &lt;Surface &nbsp;width={400} height={400} ref = &#39;theImg&#39;&gt;</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;GL.Node shader = {helloGL}</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uniforms = {{factor: 3, image: img}}</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /&gt;</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &lt;/Surface&gt;</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;View style ={{flexDirection: &#39;row&#39;}}&gt;</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &lt;Button style={{flex:1}} text=&#39;Save and Upload&#39; value = &quot;NORMAL RAISED&quot; raised={true} onPress = {this.capture.bind(this)} &gt;</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/Button&gt;</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &lt;/View&gt;</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &lt;/View&gt;</span></p><p class="c3 c5"><span class="c2"></span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &lt;/View&gt;</span></p><p class="c3 c5"><span class="c2"></span></p><p class="c3"><span class="c2"></pre></code></span></p><p class="c3 c5"><span class="c2"></span></p><p class="c3"><span class="c2">The variable &#39;img&#39; is a uri string to our image (in this case I just use the uri path returned from the CameraView section of this tutorial). &nbsp;</span></p><p class="c3 c5"><span class="c2"></span></p><p class="c3"><span class="c2">The variable helloGL is a lot more exciting. &nbsp;This is an object that contains an OpenGL (Yes! The OpenGL language is embedded within our javascript) algorithm that used used to increase the saturation of our image. &nbsp;The amount of saturation is controlled by the &#39;factor&#39; and can go up to 8.</span></p><p class="c3 c5"><span class="c2"></span></p><p class="c3"><span class="c2">Here is the helloGL variable:</span></p><p class="c3"><span class="c2"><pre><code></span></p><p class="c3"><span class="c2">var helloGL = {frag: `</span></p><p class="c3"><span class="c2">precision highp float;</span></p><p class="c3"><span class="c2">varying vec2 uv;</span></p><p class="c3"><span class="c2">uniform sampler2D image;</span></p><p class="c3"><span class="c2">uniform float factor;</span></p><p class="c3"><span class="c2">void main () {</span></p><p class="c3"><span class="c2">&nbsp; vec4 c = texture2D(image, uv);</span></p><p class="c3"><span class="c2">&nbsp; // Algorithm from Chapter 16 of OpenGL Shading Language</span></p><p class="c3"><span class="c2">&nbsp; const vec3 W = vec3(0.2125, 0.7154, 0.0721);</span></p><p class="c3"><span class="c2">&nbsp; gl_FragColor = vec4(mix(vec3(dot(c.rgb, W)), c.rgb, factor), c.a);</span></p><p class="c3"><span class="c2">}</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; `</span></p><p class="c3"><span class="c2">&nbsp; }</span></p><p class="c3"><span class="c2"></pre></code></span></p><p class="c3 c5"><span class="c2"></span></p><p class="c3"><span class="c8"><a class="c6" href="https://www.google.com/url?q=https://en.wikipedia.org/wiki/OpenGL_Shading_Language&amp;sa=D&amp;ust=1470383786083000&amp;usg=AFQjCNEijEQeqpeUJVbjqVYhuKbBPrmOIQ">OpenGL</a></span><span>&nbsp;is fairly complex but gl-react-native provides some </span><span class="c8"><a class="c6" href="https://www.google.com/url?q=https://github.com/ProjectSeptemberInc/gl-react-native/tree/master/example/src/Simple&amp;sa=D&amp;ust=1470383786084000&amp;usg=AFQjCNGMpQQmtAU7i5vNdzgKVO6PpiEOkw">very useful examples</a></span><span class="c2">&nbsp;that can be used to get started. &nbsp;The example above is the &#39;Saturation&#39; frag.</span></p><p class="c3 c5"><span class="c2"></span></p><p class="c3"><span class="c2">Here is an example of an image with the above filter at a factor of 1, 3, and 8:</span></p><p class="c3 c5"><span class="c2"></span></p><p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 195.10px; height: 347.50px;"><img alt="" src="images4/image01.png" style="width: 195.10px; height: 347.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 194.24px; height: 347.50px;"><img alt="" src="images4/image00.png" style="width: 194.24px; height: 347.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 198.04px; height: 351.50px;"><img alt="" src="images4/image02.png" style="width: 198.04px; height: 351.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3 c5"><span class="c2"></span></p><p class="c3 c5"><span class="c2"></span></p><h3 class="c3 c4" id="h.tqjazs4z8soo"><span class="c1">Your filter is done!</span></h3><p class="c3"><span>You officially have your filter set up! &nbsp;You can build on this framework and add many more filters. &nbsp;</span><span class="c8"><a class="c6" href="https://www.google.com/url?q=https://www.amazon.com/dp/B005GV32H6/ref%3Ddp-kindle-redirect?_encoding%3DUTF8%26btkr%3D1%23nav-subnav&amp;sa=D&amp;ust=1470383786087000&amp;usg=AFQjCNEnoqA6_dxxzF3pMMunQlwWVxacVw">The OpenGL Cookbook</a></span><span class="c2">&nbsp;is a well reviewed guide that can help you understand how to images can be manipulated.</span></p><h3 class="c3 c4" id="h.7ac37nmhmjp3"><span class="c1">Save that image</span></h3><p class="c3 c5"><span class="c2"></span></p><p class="c3"><span>Finally, and very importantly, we can now save the filtered image that we have created. &nbsp;</span><span class="c8"><a class="c6" href="https://www.google.com/url?q=https://github.com/ProjectSeptemberInc/gl-react-native/blob/29bebfc684ff04fc90dd86f5889b46080533c589/example/src/Simple/index.js%23L91&amp;sa=D&amp;ust=1470383786088000&amp;usg=AFQjCNG5B2mXpPaQRlfhsJRicVN5yo45QA">The examples</a></span><span class="c2">&nbsp;have a great example capture function that shows off the different options. &nbsp;The options that I use allow me to save a .jpg of the filtered image as a base64 encoded string (which I will be sending to a server for storage).</span></p><p class="c3 c5"><span class="c2"></span></p><p class="c3"><span class="c2"><pre><code></span></p><p class="c3"><span class="c2">&nbsp; const captureConfig = {</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; quality: 1,</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; type: &quot;jpg&quot;,</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; format: &quot;base64&quot;</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; };</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; this.refs.theImg</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; .captureFrame(captureConfig)</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; .then(captured =&gt;{ </span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; this.uploadPic(captured); //upload the picture to the server</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; this.setState({ captured, captureConfig })});</span></p><p class="c3"><span class="c2">&nbsp; }</span></p><p class="c3"><span class="c2"></pre></code></span></p><p class="c3 c5"><span class="c2"></span></p>

<nav aria-label="Page navigation">
  <ul class="pagination">
    <li class="page-item">
      <a class="page-link" href="HowTo3.html" aria-label="Previous">
        <span aria-hidden="true">&laquo;</span>
        <span class="sr-only">Previous</span>
      </a>
    </li>
    <li class="page-item"><a class="page-link" href="HowTo.html">1</a></li>
    <li class="page-item"><a class="page-link" href="HowTo2.html">2</a></li>
    <li class="page-item"><a class="page-link" href="HowTo3.html">3</a></li>
    <li class="page-item"><a class="page-link" href="HowTo4.html">4</a></li>
    <li class="active page-item"><a class="page-link" href="HowTo5.html">5</a></li>
    <li class="page-item">
      <a class="page-link" href="HowTo5.html" aria-label="Next">
        <span aria-hidden="true">&raquo;</span>
        <span class="sr-only">Next</span>
      </a>
    </li>
  </ul>
</nav>


</body></html>